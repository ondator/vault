# Open agile architecture
## Wtf?
После того как Open Group понял, что Agile'зировать TOGAF невозможно, они создали абсолютно новый фреймворк, рассчитанный на более зрелые (или менее заскорузлые) организации.
Надо сказать, что в отличии от TOGAF, O-AA сложно назвать фреймворком, на мой взгляд, ему не хватает системности и он, скорее, представляет собой просто ворох техник и лучших практик. Но, при этом, подобрано действительно со вкусом.

## Область применимости
В отличии от TOGAF, эта штука ждет достаточно высокого уровня зрелости IT и бизнеса:

### Целеполагание
- должна быть стратегия
- стратегия должна пересматриваться в зависимости от внешних данных (т.н. weak signals)
- должны быть измеримые цели и метрики, которые можно снять здесь и сейчас
- бизнес готов в изменениям и понимает, что уметь меняться жизненно важно

### Бизнесс
- Выстраиваем работу вокруг продуктов и value streams, а не проектов
- Важен TTM
- Есть циклы обратной связи (Hypotesis->Build->Measure->Learn)

Глядя на все это, кажется, что это явно не про производственные компании, а про ИТ или стартапы. Так же это явно не про КИИ и Mission Critical системы

## Что делать-то

O-AA делит архитектуру на 2 части: 
- Intentional проектирование: это то, что садимся и проектируем сразу на берегу
- Эмержентную (continuous) архитектуру: это то, что родится в результате синергии само внутри
Т.о. первым делом, надо понять что мы будем дизайнить up-front, а что оставим как эмержентную составляющую. Тут, надо сказать, что O-AA очень красиво определяет скоуп архитектуры впринципе: берем все решения и делим на группы по признакам
    1. возможность переобуться
    2. область охвата (скоуп) решения
Так вот, если нет возможности переобуться, то это архитектура, а если есть, то это эксперементы xD
Что касается разделения на Intentional и emergent, то O-AA топит за то, что бы Intentional часть была значительно меньше эмержентной и... вобщем-то и все. Конкретных рекомендаций тут больше нет, но намекает как будто бы на следующее: если у вас решение архитектурное и скоуп большой, то надо проектировать up-front. Сомнительно, но окэй. Кмк, лучше посчитать классически через риски и принимать решение из стоимости, но для начала, табличка с переобуванием/скоупом просто шикарна. 

### Intentional
Ну собственно, садимся и принимаем важные арх. решения. Документировать решения предлагается ADRками...ну тоже такое, причем моделировать не предлагается совсем, только держать ворох ADRок. Кмк, сомнительно. Я бы все-таки имел реестр целей, стейкхолдеров, рисков и капабилити хотя бы в эксель-табличках, а лучше бы архимейтом и целевую тех. архитектуру на уровне контекстов С4 в этом самом С4, ну и АДРки с описанием "почему так"

### Continuous
Тут предлагается выстроить процессы, стандарты и ограничения для того что бы магия эмержентности заиграла всеми красками. Начнем с того, что мы должны понять ограничения нашей системы. Явно это не прописано, но, судя по всему, садимся и итеративно ведем реестр внешних драйверов. Дальше нужно научиться как-то в реалтайме проверять соответвие этим ограничениям. Тут предлагается во-первых завести [fitness functions](./evolutionary_architecture.md) в стиле Нила Форда, а во-вторых завести некие guardrails. Эти "ограждения" -- это просто набор стандартов, за которыми кто-то присматривает (специально обученная oversight team). К FF вопросов нет, а вот к guardrails есть. В итоге, конечно, все это сведется к классической схеме экспертных центров, где специально обученная oversight team должна будет в обязательном порядке дать согласование на запуск решения в жизнь (привет ИБиТЗ компании СИБУР). O-AA, конечно, говорит, что надо всеми силами избегать права вето у oversight team и каждый случай должен рассматриваться индивидуально и вот это все, но чет я не видел вменяемой реализации.
В финале предлагается собрать работы и засунуть их в архитектурный роадмап, предварительно продав идею архитектурной эволюции (и этого самого роадмапа) бизнесу. Ну кажется, что продавать надо было сначала, но в целом не поспоришь

### Governance
Рядом с архитектурой всегда лежит арх.надзор. Это вот те все арх. комитеты, арх. советы и пр. круги ада согласований, которые надо пройти что бы Change увидел жизнь. O-AA отвергает традиционные подходы с экспертными группами, т.к. дескать, аджайл идет маленькими итерациями и оно с одной стороны как бы "не достойно внимания сильных мира сего", а с другой стороны ад согласований недостаточно шустрый и гибкий для аджайл процесса. Что же предлагается? А не предлагается особно ничего. Во-первых, предлагают оставить классически-централизованными стратегию, бюджеты, риски и комплаенс, а остальное раскидать по аджайл командам и выставить им OKR'ы которые челенджить раз в период.

### Принципы

В TOGAF в сове время была такая штука как принципы: это какие-то достаточно абстрактные лозунги на которых строится ваша компания. Эта шляпа воплне может быть записана в виде миссии. Что-то типа "безопасность без компромиссов" или "быстрее, выше, сильнее". В тогафе предлагалось сформулировать это самим, а тут это уже выдали готовое и назвали "аксиомами". Перечислять тут не буду, но все это про то что бы быть более гибким, единорожным и менее заскорузлым

### Стратегия

Тут вот откровенно не понравилось. Все рекомендации сводятся к использованию OKR/Hoshin и top-down проработке и донесению стратегии до широких масс, при этом самой сути раскрыто не было. Кмк, тут лучше пойти почитать "Конкурентную стратегию" Портера или хотя бы HBR

### Орг. структура

Тут предлагается перейти от проектных команд к продуктовым, при этом организовать оргу в 2х типах:
- stream-aligned (классические продуктовые аджайл команды, которые делают велью) vs core teams (команды, которые делают платформы)
- competence teams -- это гильдии в модели Spotify. Т.е. это некие центры компетенций, которые между собой делятся опытом и всячески кросс-опыляются

### Пользовательский опыт и Value streams

Вот тут, кажется, больше про стратегию чем в разделе стратегия. В общем, идея такая -- надо найти свою стратегию (что мы можем делать лучше других на определенных сегментах рынка или какую незакрытую потребность закрыть у фокусной группы) через поиск потребностей, исследования рынка и т.д. Далее формируем value stream'ы для того что бы value поставлялось к пользователям посредством наших продуктов. Value stream'ы при этом надо смапить на capabilities отдельных продуктов. Более детально расписывать не буду, т.к. откровенно говоря, не моя тема, но на первый взгляд все достаточно здраво. Единственное, децл туманно расписана связь между мапингом value stream'ов на продукты, а, кмк, тут больше всего болей

### Data и application

Тут, как мне кажется, просто накидали разных bleeding edge подходов и технологий типа DDD, DataMesh, DevOps, CQRS-ES, EventStorming и т.д. при этом достаточно тяжело понять как тут построить на этом полноценный архитектурный процесс, но, благо можно почитать [Evolutionary Architecture](./evolutionary_architecture.md) Нила Форда и станет немножечко понятнее как с этим жить

## Итого

Как мне кажется, стандарт очень сырой. Самое ценное что отсюда можно вынести -- это список литературы, вот он прям топовый, а сам стандарт использовать как некий фреймворк невозможно. Уж очень все неструктурированно, туманно и расплывчато. Тут, наверное, расскажу как я делаю agile architecture посматривая в сторону O-AA:
1. во-первых надо четко выровняться с бизнесом в области стратегии и мотивации. Тут я не вижу особо разницы какой у вас подход в организации, Agile или old school, действуем примерно одинаково:
    1. добываем откуда-то цели, драйвера и увязываем это со стейкхолдерами. Важно что бы у каждой цели был понятный драйвер и стейкхолдер, что бы понимать Что делаем (цель), зачем (драйвер) и за чей счет (стейкхолдер)
    2. дальше строим велью стримы и capabilities map. Надо понимать какая цельбудет реализована каким стримом и какие продукты какими capabilities будут реализовывать какие стримы. Это нужно что бы не было потом вот этой вони от продуктологов "я это в своем продукте не вижу".
    
    По результатам этих 2 шагов у вас должна появиться картинка в archimate.
2. Рисуем целевую helicopter view архитектуру. Можно прям C4 диаграмму контекстов
3. Прикидываем фитнесс-функции для наших систем в соотвествии с целями
4. Обязательно просим разработчиков вкрячить в продукты structurizr или другое аналогичное средство, что бы актуальную as is архитектуру можно было в любой момент посмотреть прямо из кода
5. Запускаем agile процесс. 
    1. Каждый спринт оцениваем скоуп и понимаем (например через EventStorming) влияет ли это на архитектуру (есть ли решения типа 1, т.е. без возможности переобуться). Если есть, то принимаем решение вместе с командой и фиксируем в ADR. Если решение нужно принять, но можно чуть попозже, то фиксируем проблематику и варианты в RFC
    2. Появились ли какие-то новые вводные в целях или capabilities map? Если да, то запихиваем в скоуп релиза реализацию новых fitness функций
    3. в конце спринта смотрим на сгенерированные структуризром диаграммы, проверяем фитнесс функции (если не автоматические), принимаем решение о выпуске релиза
В идеале размер этой итерации можно схлопнуть до одного комита, если внедрить Trunk-based-development и сделать все фитнесс-функции, включая QA, DevSecOps и Chaos Engineering автоматическими, но реально я такого не видел













